<!doctype html><html><head><link rel="stylesheet" href="http://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css" /><script src="http://code.jquery.com/jquery-1.10.1.min.js"></script><script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script><script type="text/javascript" src="http://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0"></script><script type="text/javascript">var map = null;var infoBox = null;var bing = Microsoft.Maps; //alias $$(function() {    map = new bing.Map($$('#myMap').get(0), {credentials: 'your-key-here', mapTypeId: bing.MapTypeId.road});	infoBox = new bing.Infobox(map.getCenter(), {width: 200, height: 100, visible: false});	    $$( "input[type=submit]" )    .button()    .click(function( event ) {        event.preventDefault();        //jquery ajax call        $$.get("/coordinates", $$("form").serialize(),            function(data){                $$("div#result").empty();                var locations = [];                $$.each(data, function(i, item){                    if(item[0] == "error"){                        $$("div#result").append('<p><em>'+ item[1] +'</em></p>');                    }else{                        $$("div#result").append($$('<p></p>').text(item[1] + ': ' + item[2][0] + ', ' + item[2][1]));                        locations.push( {lat: item[2][0], lon: item[2][1], addr: item[1]});                    }                });                updateMap(locations);        }, "json");    });});function updateMap(locations){    clearMap();	map.entities.push(infoBox);    $$.each(locations, function(i, l){       var pushpin = new bing.Pushpin(new bing.Location(l.lat, l.lon), null);	   pushpin.myLocation = l;       map.entities.push(pushpin);	   pushpin.myHandlerId = bing.Events.addHandler(pushpin, "click", showInfoBox);	   if(i == 0){	       map.setView({ zoom: 8, center: new bing.Location(l.lat, l.lon) })	   }    });		//and remove credentials message until Microsoft sorts out this key-in-plain-text stupidity - don't do this at home	$$('div.OverlaysBL').next().hide(); //just a little hack}function clearMap(){    while(map.entities.getLength()){		var entity = map.entities.pop();		if(entity.myHandlerId){			bing.Events.removeHandler(entity.myHandlerId);		}	}}function showInfoBox(e){	//var mapLocation = new bing.Location(location.lat, location.lon);	infoBox.setLocation(e.target.getLocation());	var location = e.target.myLocation;	infoBox.setOptions({ visible: true, title: location.addr, description: "(" + location.lat + ", " + location.lon + ")"});}</script></head><body>	<p>Please enter address per line to get their coordinates</p>	<form method="get">	<textarea id="addresses" name="addresses"></textarea>	<input type="submit" value="submit" />	</form>	<div id="result">	</div>	<div id='myMap' style="position:relative; width:900px; height:600px;"></div></body>